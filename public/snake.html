<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>SPACEWORM.EXE</title>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap"
      rel="stylesheet"
    />

    <!-- Main Stylesheet -->
    <link rel="stylesheet" href="snake.css" />
  </head>
  <body>
    <a href="#game-field" class="skip-link">Skip to game</a>
    
    <!-- START OVERLAY -->
    <div id="start-overlay" class="overlay" role="dialog" aria-labelledby="start-title">
      <div class="overlay-content">
        <h1 id="start-title">SPACEWORM.EXE</h1>
        <button id="snake-play-button">CLICK TO START</button>
      </div>
    </div>

    <!-- GAME OVER OVERLAY -->
    <div id="game-over-overlay" class="overlay hidden" role="dialog" aria-labelledby="game-over-title">
      <div class="overlay-content">
        <h1 id="game-over-title">Game Over</h1>
        <p id="final-score">Your score: 0</p>
        <div id="score-entry">
          <label for="name-input" class="sr-only">Enter your name</label>
          <input
            id="name-input"
            type="text"
            placeholder="Your Name (7 chars)"
            maxlength="7"
            aria-label="Your name for high score"
          />
          <button id="submit-score">Submit Score</button>
        </div>
        <ol id="high-scores-list" aria-label="High scores"></ol>
        <button id="play-again-button">Play Again</button>
      </div>
    </div>

    <!-- GAME FIELD -->
    <div id="game-field" role="application" aria-label="Spaceworm game">
      <canvas id="snake-canvas" aria-label="Game canvas"></canvas>
    </div>

    <!-- HUD -->
    <div id="snake-ui" role="status" aria-live="polite">
      <span id="snake-score">Score: 0</span> |
      <span id="snake-level">Level: 1</span> |
      <span id="snake-best">Best: 0</span> |
      <span id="snake-status">Running</span>
    </div>

    <!-- MUTE BUTTON -->
    <button id="mute-button" aria-label="Toggle sound">ðŸ”Š</button>

    <!-- JOYSTICK -->
    <div id="joystick" aria-label="Touch joystick for mobile">
      <div id="joystick-base">
        <div id="joystick-stick"></div>
      </div>
    </div>

    <!-- MUSIC -->
    <audio
      id="snake-music"
      src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-5.mp3"
      loop
      preload="auto"
    ></audio>

    <!-- Main Script -->
    <script src="snake.js"></script>
    <script>
      // Check for saved theme preference and apply it
      document.addEventListener('DOMContentLoaded', () => {
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme === 'light') {
          document.body.classList.add('light-mode');
        }
        
        // Listen for theme changes from parent window
        window.addEventListener('storage', (event) => {
          if (event.key === 'theme') {
            if (event.newValue === 'light') {
              document.body.classList.add('light-mode');
            } else {
              document.body.classList.remove('light-mode');
            }
          }
        });
      });
    </script>
  </body>
</html>
